{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v5.json", "dbt_version": "1.7.13", "generated_at": "2024-05-13T12:03:08.170274Z", "invocation_id": "727a7413-6450-483d-9d1d-b75e09dd1337", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-13T12:03:06.722338Z", "completed_at": "2024-05-13T12:03:06.725285Z"}, {"name": "execute", "started_at": "2024-05-13T12:03:06.728369Z", "completed_at": "2024-05-13T12:03:06.728369Z"}], "thread_id": "Thread-4", "execution_time": 0.08945083618164062, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.dbtearn.seed_full_moon_dates", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-13T12:03:06.645535Z", "completed_at": "2024-05-13T12:03:06.731394Z"}, {"name": "execute", "started_at": "2024-05-13T12:03:06.736730Z", "completed_at": "2024-05-13T12:03:06.736730Z"}], "thread_id": "Thread-1", "execution_time": 0.12427020072937012, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbtearn.src_hosts", "compiled": true, "compiled_code": "WITH raw_hosts AS (\r\n SELECT\r\n *\r\n FROM\r\n AIRBNB.RAW.RAW_HOSTS\r\n)\r\nSELECT\r\n id AS host_id,\r\n NAME AS host_name,\r\n is_superhost,\r\n created_at,\r\n updated_at\r\nFROM\r\n raw_hosts", "relation_name": "AIRBNB.DEV.src_hosts"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-13T12:03:06.650869Z", "completed_at": "2024-05-13T12:03:06.734356Z"}, {"name": "execute", "started_at": "2024-05-13T12:03:06.739609Z", "completed_at": "2024-05-13T12:03:06.739609Z"}], "thread_id": "Thread-2", "execution_time": 0.11698460578918457, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbtearn.src_listings", "compiled": true, "compiled_code": "WITH raw_listings AS (\r\n SELECT\r\n *\r\n FROM\r\n AIRBNB.RAW.RAW_LISTINGS\r\n)\r\nSELECT\r\n id AS listing_id,\r\n name AS listing_name,\r\n listing_url,\r\n room_type,\r\n minimum_nights,\r\n host_id,\r\n price AS price_str,\r\n created_at,\r\n updated_at\r\nFROM\r\n raw_listings", "relation_name": "AIRBNB.DEV.src_listings"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-13T12:03:06.650869Z", "completed_at": "2024-05-13T12:03:06.734356Z"}, {"name": "execute", "started_at": "2024-05-13T12:03:06.739609Z", "completed_at": "2024-05-13T12:03:06.739609Z"}], "thread_id": "Thread-3", "execution_time": 0.1164243221282959, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbtearn.src_reviews", "compiled": true, "compiled_code": "WITH raw_reviews AS (\r\n SELECT\r\n *\r\n FROM\r\n AIRBNB.RAW.RAW_REVIEWS\r\n)\r\nSELECT\r\n listing_id,\r\n date AS review_date,\r\n reviewer_name,\r\n comments AS review_text,\r\n sentiment AS review_sentiment\r\nFROM\r\n raw_reviews", "relation_name": "AIRBNB.DEV.src_reviews"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-13T12:03:06.739609Z", "completed_at": "2024-05-13T12:03:06.739609Z"}, {"name": "execute", "started_at": "2024-05-13T12:03:06.756583Z", "completed_at": "2024-05-13T12:03:06.756583Z"}], "thread_id": "Thread-4", "execution_time": 0.024044036865234375, "adapter_response": {}, "message": null, "failures": null, "unique_id": "snapshot.dbtearn.scd_raw_hosts", "compiled": true, "compiled_code": "  \n\n  \n\nselect * \nfrom AIRBNB.raw.raw_hosts\n", "relation_name": "AIRBNB.DEV.scd_raw_hosts"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-13T12:03:06.761921Z", "completed_at": "2024-05-13T12:03:06.765912Z"}, {"name": "execute", "started_at": "2024-05-13T12:03:06.779519Z", "completed_at": "2024-05-13T12:03:06.779519Z"}], "thread_id": "Thread-1", "execution_time": 0.02657151222229004, "adapter_response": {}, "message": null, "failures": null, "unique_id": "snapshot.dbtearn.scd_raw_listings", "compiled": true, "compiled_code": "\n\n\n\nselect * FROM AIRBNB.raw.raw_listings\n", "relation_name": "AIRBNB.DEV.scd_raw_listings"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-13T12:03:06.770132Z", "completed_at": "2024-05-13T12:03:06.800584Z"}, {"name": "execute", "started_at": "2024-05-13T12:03:06.800584Z", "completed_at": "2024-05-13T12:03:06.800584Z"}], "thread_id": "Thread-2", "execution_time": 0.041750431060791016, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbtearn.dim_hosts_cleansed", "compiled": true, "compiled_code": "WITH src_hosts AS (\n SELECT\n *\n FROM\n AIRBNB.DEV.src_hosts\n)\nSELECT\n host_id,\n NVL(\n host_name,\n 'Anonymous'\n ) AS host_name,\n is_superhost,\n created_at,\n updated_at\nFROM\n src_hosts", "relation_name": "AIRBNB.DEV.dim_hosts_cleansed"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-13T12:03:06.775375Z", "completed_at": "2024-05-13T12:03:06.800584Z"}, {"name": "execute", "started_at": "2024-05-13T12:03:06.816211Z", "completed_at": "2024-05-13T12:03:06.816211Z"}], "thread_id": "Thread-3", "execution_time": 0.055201053619384766, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbtearn.dim_listings_cleansed", "compiled": true, "compiled_code": "WITH src_listings AS (\n SELECT\n *\n FROM\n AIRBNB.DEV.src_listings\n)\nSELECT\n listing_id,\n listing_name,\n room_type,\n CASE\n WHEN minimum_nights = 0 THEN 1\n ELSE minimum_nights\n END AS minimum_nights,\n host_id,\n REPLACE(\n price_str,\n '$'\n ) :: NUMBER(\n 10,\n 2\n ) AS price,\n created_at,\n updated_at\nFROM\n src_listings", "relation_name": "AIRBNB.DEV.dim_listings_cleansed"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-13T12:03:06.782391Z", "completed_at": "2024-05-13T12:03:06.816211Z"}, {"name": "execute", "started_at": "2024-05-13T12:03:06.816211Z", "completed_at": "2024-05-13T12:03:06.816211Z"}], "thread_id": "Thread-4", "execution_time": 0.04183459281921387, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbtearn.fct_reviews", "compiled": true, "compiled_code": "\nWITH src_reviews AS (\n SELECT * FROM AIRBNB.DEV.src_reviews\n)\nSELECT \n md5(cast(coalesce(cast(listing_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(review_date as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(reviewer_name as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(review_text as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT))\n AS review_id,\n * \n FROM src_reviews\nWHERE review_text is not null\n\n AND review_date > (select max(review_date) from AIRBNB.DEV.fct_reviews)\n", "relation_name": "AIRBNB.DEV.fct_reviews"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-13T12:03:06.831832Z", "completed_at": "2024-05-13T12:03:06.863080Z"}, {"name": "execute", "started_at": "2024-05-13T12:03:06.863080Z", "completed_at": "2024-05-13T12:03:06.863080Z"}], "thread_id": "Thread-1", "execution_time": 0.04686856269836426, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbtearn.FULL_MOON_REVIEWS", "compiled": true, "compiled_code": "\nWITH fct_reviews AS (\n SELECT * FROM AIRBNB.DEV.fct_reviews\n),\nfull_moon_dates AS (\n SELECT * FROM AIRBNB.DEV.seed_full_moon_dates\n)\nSELECT\n r.*,\n CASE\n WHEN fm.full_moon_date IS NULL THEN 'not full moon'\n ELSE 'full moon'\n END AS is_full_moon\nFROM\n fct_reviews\n r\n LEFT JOIN full_moon_dates\n fm\n ON (TO_DATE(r.review_date) = DATEADD(DAY, 1, fm.full_moon_date))", "relation_name": "AIRBNB.DEV.FULL_MOON_REVIEWS"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-13T12:03:06.831832Z", "completed_at": "2024-05-13T12:03:06.863080Z"}, {"name": "execute", "started_at": "2024-05-13T12:03:06.878706Z", "completed_at": "2024-05-13T12:03:06.878706Z"}], "thread_id": "Thread-2", "execution_time": 0.06249523162841797, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbtearn.dim_listings_w_hosts", "compiled": true, "compiled_code": "WITH\nl AS (\n SELECT\n *\n FROM\n AIRBNB.DEV.dim_listings_cleansed\n),\nh AS (\n SELECT *\n FROM AIRBNB.DEV.dim_hosts_cleansed\n)\nSELECT\n l.listing_id,\n l.listing_name,\n l.room_type,\n l.minimum_nights,\n l.price,\n l.host_id,\n h.host_name,\n h.is_superhost as host_is_superhost,\n l.created_at,\n GREATEST(l.updated_at, h.updated_at) as updated_at\nFROM l\nLEFT JOIN h ON (h.host_id = l.host_id)", "relation_name": "AIRBNB.DEV.dim_listings_w_hosts"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-13T12:03:06.831832Z", "completed_at": "2024-05-13T12:03:06.878706Z"}, {"name": "execute", "started_at": "2024-05-13T12:03:06.878706Z", "completed_at": "2024-05-13T12:03:06.878706Z"}], "thread_id": "Thread-3", "execution_time": 0.08461976051330566, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbtearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        room_type as value_field,\n        count(*) as n_records\n\n    from AIRBNB.DEV.dim_listings_cleansed\n    group by room_type\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'Entire home/apt','Private room','Shared room','Hotel room'\n)\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-13T12:03:06.863080Z", "completed_at": "2024-05-13T12:03:06.863080Z"}, {"name": "execute", "started_at": "2024-05-13T12:03:06.878706Z", "completed_at": "2024-05-13T12:03:06.878706Z"}], "thread_id": "Thread-4", "execution_time": 0.08461976051330566, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbtearn.dim_listings_minumum_nights", "compiled": true, "compiled_code": "SELECT\n *\nFROM\n AIRBNB.DEV.dim_listings_cleansed\nWHERE minimum_nights < 1\nLIMIT 10", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-13T12:03:06.935752Z", "completed_at": "2024-05-13T12:03:06.946621Z"}, {"name": "execute", "started_at": "2024-05-13T12:03:06.950414Z", "completed_at": "2024-05-13T12:03:06.950414Z"}], "thread_id": "Thread-4", "execution_time": 0.04958319664001465, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbtearn.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313", "compiled": true, "compiled_code": "\nSELECT\n *\nFROM\n AIRBNB.DEV.dim_listings_cleansed\nWHERE\n minimum_nights < 1\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-13T12:03:06.916458Z", "completed_at": "2024-05-13T12:03:06.947620Z"}, {"name": "execute", "started_at": "2024-05-13T12:03:06.950414Z", "completed_at": "2024-05-13T12:03:06.950414Z"}], "thread_id": "Thread-3", "execution_time": 0.04958319664001465, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbtearn.not_null_dim_listings_cleansed_listing_id.2da437bec9", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect listing_id\nfrom AIRBNB.DEV.dim_listings_cleansed\nwhere listing_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-13T12:03:06.916458Z", "completed_at": "2024-05-13T12:03:06.948617Z"}, {"name": "execute", "started_at": "2024-05-13T12:03:06.950414Z", "completed_at": "2024-05-13T12:03:06.950414Z"}], "thread_id": "Thread-2", "execution_time": 0.04958319664001465, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbtearn.not_null_dim_listings_cleansed_host_id.084e4105be", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect host_id\nfrom AIRBNB.DEV.dim_listings_cleansed\nwhere host_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-13T12:03:06.966076Z", "completed_at": "2024-05-13T12:03:06.981700Z"}, {"name": "execute", "started_at": "2024-05-13T12:03:06.981700Z", "completed_at": "2024-05-13T12:03:06.981700Z"}], "thread_id": "Thread-3", "execution_time": 0.03128552436828613, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbtearn.unique_dim_listings_cleansed_listing_id.930e4e859e", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    listing_id as unique_field,\n    count(*) as n_records\n\nfrom AIRBNB.DEV.dim_listings_cleansed\nwhere listing_id is not null\ngroup by listing_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-13T12:03:06.950414Z", "completed_at": "2024-05-13T12:03:06.981700Z"}, {"name": "execute", "started_at": "2024-05-13T12:03:06.981700Z", "completed_at": "2024-05-13T12:03:06.981700Z"}], "thread_id": "Thread-4", "execution_time": 0.03128552436828613, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbtearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select host_id as from_field\n    from AIRBNB.DEV.dim_listings_cleansed\n    where host_id is not null\n),\n\nparent as (\n    select host_id as to_field\n    from AIRBNB.DEV.dim_hosts_cleansed\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-13T12:03:06.878706Z", "completed_at": "2024-05-13T12:03:08.054414Z"}, {"name": "execute", "started_at": "2024-05-13T12:03:08.054414Z", "completed_at": "2024-05-13T12:03:08.054414Z"}], "thread_id": "Thread-1", "execution_time": 1.2915678024291992, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbtearn.no_nulls_in_dim_listings", "compiled": true, "compiled_code": "\n SELECT * FROM AIRBNB.DEV.dim_listings_cleansed WHERE\n LISTING_ID IS NULL OR\n LISTING_NAME IS NULL OR\n ROOM_TYPE IS NULL OR\n MINIMUM_NIGHTS IS NULL OR\n HOST_ID IS NULL OR\n PRICE IS NULL OR\n CREATED_AT IS NULL OR\n UPDATED_AT IS NULL OR\n \n FALSE\n", "relation_name": null}], "elapsed_time": 3.260235071182251, "args": {"populate_cache": true, "enable_legacy_logger": false, "macro_debugging": false, "vars": {}, "use_colors": true, "output": "text", "log_file_max_bytes": 10485760, "which": "compile", "invocation_command": "dbt compile --target-path=prod-run-artifacts", "introspect": true, "profiles_dir": "C:\\Users\\Sunita D Agadi\\.dbt", "use_colors_file": true, "select": [], "strict_mode": false, "defer": false, "partial_parse": true, "exclude": [], "log_path": "D:\\DBT_first\\dbtearn\\logs", "version_check": true, "printer_width": 80, "warn_error_options": {"include": [], "exclude": []}, "log_format_file": "debug", "partial_parse_file_diff": true, "project_dir": "D:\\DBT_first\\dbtearn", "log_level_file": "debug", "quiet": false, "print": true, "write_json": true, "cache_selected_only": false, "target_path": "prod-run-artifacts", "send_anonymous_usage_stats": true, "static_parser": true, "inject_ephemeral_ctes": true, "favor_state": false, "show_resource_report": false, "indirect_selection": "eager", "log_level": "info", "log_format": "default"}}