{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v5.json", "dbt_version": "1.7.13", "generated_at": "2024-05-13T11:57:59.380112Z", "invocation_id": "b10681a7-4c3d-44d3-aede-020f46a62352", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-13T11:57:57.835888Z", "completed_at": "2024-05-13T11:57:57.835888Z"}, {"name": "execute", "started_at": "2024-05-13T11:57:57.835888Z", "completed_at": "2024-05-13T11:57:57.835888Z"}], "thread_id": "Thread-4", "execution_time": 0.031151533126831055, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.dbtearn.seed_full_moon_dates", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-13T11:57:57.852573Z", "completed_at": "2024-05-13T11:57:57.852573Z"}, {"name": "execute", "started_at": "2024-05-13T11:57:57.852573Z", "completed_at": "2024-05-13T11:57:57.852573Z"}], "thread_id": "Thread-4", "execution_time": 0.01668572425842285, "adapter_response": {}, "message": null, "failures": null, "unique_id": "snapshot.dbtearn.scd_raw_hosts", "compiled": true, "compiled_code": "  \n\n  \n\nselect * \nfrom AIRBNB.raw.raw_hosts\n", "relation_name": "AIRBNB.DEV.scd_raw_hosts"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-13T11:57:57.834601Z", "completed_at": "2024-05-13T11:57:57.868198Z"}, {"name": "execute", "started_at": "2024-05-13T11:57:57.873267Z", "completed_at": "2024-05-13T11:57:57.873267Z"}], "thread_id": "Thread-3", "execution_time": 0.0772087574005127, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbtearn.src_reviews", "compiled": true, "compiled_code": "WITH raw_reviews AS (\r\n SELECT\r\n *\r\n FROM\r\n AIRBNB.RAW.RAW_REVIEWS\r\n)\r\nSELECT\r\n listing_id,\r\n date AS review_date,\r\n reviewer_name,\r\n comments AS review_text,\r\n sentiment AS review_sentiment\r\nFROM\r\n raw_reviews", "relation_name": "AIRBNB.DEV.src_reviews"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-13T11:57:57.810349Z", "completed_at": "2024-05-13T11:57:57.871273Z"}, {"name": "execute", "started_at": "2024-05-13T11:57:57.881246Z", "completed_at": "2024-05-13T11:57:57.881246Z"}], "thread_id": "Thread-1", "execution_time": 0.10365080833435059, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbtearn.src_hosts", "compiled": true, "compiled_code": "WITH raw_hosts AS (\r\n SELECT\r\n *\r\n FROM\r\n AIRBNB.RAW.RAW_HOSTS\r\n)\r\nSELECT\r\n id AS host_id,\r\n NAME AS host_name,\r\n is_superhost,\r\n created_at,\r\n updated_at\r\nFROM\r\n raw_hosts", "relation_name": "AIRBNB.DEV.src_hosts"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-13T11:57:57.818977Z", "completed_at": "2024-05-13T11:57:57.872269Z"}, {"name": "execute", "started_at": "2024-05-13T11:57:57.882243Z", "completed_at": "2024-05-13T11:57:57.882243Z"}], "thread_id": "Thread-2", "execution_time": 0.08993291854858398, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbtearn.src_listings", "compiled": true, "compiled_code": "WITH raw_listings AS (\r\n SELECT\r\n *\r\n FROM\r\n AIRBNB.RAW.RAW_LISTINGS\r\n)\r\nSELECT\r\n id AS listing_id,\r\n name AS listing_name,\r\n listing_url,\r\n room_type,\r\n minimum_nights,\r\n host_id,\r\n price AS price_str,\r\n created_at,\r\n updated_at\r\nFROM\r\n raw_listings", "relation_name": "AIRBNB.DEV.src_listings"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-13T11:57:57.891523Z", "completed_at": "2024-05-13T11:57:57.896510Z"}, {"name": "execute", "started_at": "2024-05-13T11:57:57.917523Z", "completed_at": "2024-05-13T11:57:57.917523Z"}], "thread_id": "Thread-4", "execution_time": 0.037274837493896484, "adapter_response": {}, "message": null, "failures": null, "unique_id": "snapshot.dbtearn.scd_raw_listings", "compiled": true, "compiled_code": "\n\n\n\nselect * FROM AIRBNB.raw.raw_listings\n", "relation_name": "AIRBNB.DEV.scd_raw_listings"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-13T11:57:57.901902Z", "completed_at": "2024-05-13T11:57:57.943201Z"}, {"name": "execute", "started_at": "2024-05-13T11:57:57.945202Z", "completed_at": "2024-05-13T11:57:57.945202Z"}], "thread_id": "Thread-3", "execution_time": 0.05669522285461426, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbtearn.fct_reviews", "compiled": true, "compiled_code": "\nWITH src_reviews AS (\n SELECT * FROM AIRBNB.DEV.src_reviews\n)\nSELECT \n md5(cast(coalesce(cast(listing_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(review_date as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(reviewer_name as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(review_text as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT))\n AS review_id,\n * \n FROM src_reviews\nWHERE review_text is not null\n\n AND review_date > (select max(review_date) from AIRBNB.DEV.fct_reviews)\n", "relation_name": "AIRBNB.DEV.fct_reviews"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-13T11:57:57.917523Z", "completed_at": "2024-05-13T11:57:57.953377Z"}, {"name": "execute", "started_at": "2024-05-13T11:57:57.953377Z", "completed_at": "2024-05-13T11:57:57.953377Z"}], "thread_id": "Thread-1", "execution_time": 0.051474571228027344, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbtearn.dim_hosts_cleansed", "compiled": true, "compiled_code": "WITH src_hosts AS (\n SELECT\n *\n FROM\n AIRBNB.DEV.src_hosts\n)\nSELECT\n host_id,\n NVL(\n host_name,\n 'Anonymous'\n ) AS host_name,\n is_superhost,\n created_at,\n updated_at\nFROM\n src_hosts", "relation_name": "AIRBNB.DEV.dim_hosts_cleansed"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-13T11:57:57.937216Z", "completed_at": "2024-05-13T11:57:57.953377Z"}, {"name": "execute", "started_at": "2024-05-13T11:57:57.953377Z", "completed_at": "2024-05-13T11:57:57.953377Z"}], "thread_id": "Thread-2", "execution_time": 0.051474571228027344, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbtearn.dim_listings_cleansed", "compiled": true, "compiled_code": "WITH src_listings AS (\n SELECT\n *\n FROM\n AIRBNB.DEV.src_listings\n)\nSELECT\n listing_id,\n listing_name,\n room_type,\n CASE\n WHEN minimum_nights = 0 THEN 1\n ELSE minimum_nights\n END AS minimum_nights,\n host_id,\n REPLACE(\n price_str,\n '$'\n ) :: NUMBER(\n 10,\n 2\n ) AS price,\n created_at,\n updated_at\nFROM\n src_listings", "relation_name": "AIRBNB.DEV.dim_listings_cleansed"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-13T11:57:57.952177Z", "completed_at": "2024-05-13T11:57:57.953377Z"}, {"name": "execute", "started_at": "2024-05-13T11:57:57.972357Z", "completed_at": "2024-05-13T11:57:57.972357Z"}], "thread_id": "Thread-4", "execution_time": 0.02716064453125, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbtearn.FULL_MOON_REVIEWS", "compiled": true, "compiled_code": "\nWITH fct_reviews AS (\n SELECT * FROM AIRBNB.DEV.fct_reviews\n),\nfull_moon_dates AS (\n SELECT * FROM AIRBNB.DEV.seed_full_moon_dates\n)\nSELECT\n r.*,\n CASE\n WHEN fm.full_moon_date IS NULL THEN 'not full moon'\n ELSE 'full moon'\n END AS is_full_moon\nFROM\n fct_reviews\n r\n LEFT JOIN full_moon_dates\n fm\n ON (TO_DATE(r.review_date) = DATEADD(DAY, 1, fm.full_moon_date))", "relation_name": "AIRBNB.DEV.FULL_MOON_REVIEWS"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-13T11:57:57.979338Z", "completed_at": "2024-05-13T11:57:58.003482Z"}, {"name": "execute", "started_at": "2024-05-13T11:57:58.019104Z", "completed_at": "2024-05-13T11:57:58.019104Z"}], "thread_id": "Thread-3", "execution_time": 0.04575037956237793, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbtearn.dim_listings_w_hosts", "compiled": true, "compiled_code": "WITH\nl AS (\n SELECT\n *\n FROM\n AIRBNB.DEV.dim_listings_cleansed\n),\nh AS (\n SELECT *\n FROM AIRBNB.DEV.dim_hosts_cleansed\n)\nSELECT\n l.listing_id,\n l.listing_name,\n l.room_type,\n l.minimum_nights,\n l.price,\n l.host_id,\n h.host_name,\n h.is_superhost as host_is_superhost,\n l.created_at,\n GREATEST(l.updated_at, h.updated_at) as updated_at\nFROM l\nLEFT JOIN h ON (h.host_id = l.host_id)", "relation_name": "AIRBNB.DEV.dim_listings_w_hosts"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-13T11:57:57.984326Z", "completed_at": "2024-05-13T11:57:58.003482Z"}, {"name": "execute", "started_at": "2024-05-13T11:57:58.019104Z", "completed_at": "2024-05-13T11:57:58.019104Z"}], "thread_id": "Thread-1", "execution_time": 0.04475212097167969, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbtearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        room_type as value_field,\n        count(*) as n_records\n\n    from AIRBNB.DEV.dim_listings_cleansed\n    group by room_type\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'Entire home/apt','Private room','Shared room','Hotel room'\n)\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-13T11:57:57.990494Z", "completed_at": "2024-05-13T11:57:58.019104Z"}, {"name": "execute", "started_at": "2024-05-13T11:57:58.019104Z", "completed_at": "2024-05-13T11:57:58.019104Z"}], "thread_id": "Thread-2", "execution_time": 0.04475212097167969, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbtearn.dim_listings_minumum_nights", "compiled": true, "compiled_code": "SELECT\n *\nFROM\n AIRBNB.DEV.dim_listings_cleansed\nWHERE minimum_nights < 1\nLIMIT 10", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-13T11:57:58.052091Z", "completed_at": "2024-05-13T11:57:58.069721Z"}, {"name": "execute", "started_at": "2024-05-13T11:57:58.075734Z", "completed_at": "2024-05-13T11:57:58.075734Z"}], "thread_id": "Thread-1", "execution_time": 0.04496288299560547, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbtearn.not_null_dim_listings_cleansed_listing_id.2da437bec9", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect listing_id\nfrom AIRBNB.DEV.dim_listings_cleansed\nwhere listing_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-13T11:57:58.040681Z", "completed_at": "2024-05-13T11:57:58.071712Z"}, {"name": "execute", "started_at": "2024-05-13T11:57:58.076698Z", "completed_at": "2024-05-13T11:57:58.076698Z"}], "thread_id": "Thread-3", "execution_time": 0.061583757400512695, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbtearn.not_null_dim_listings_cleansed_host_id.084e4105be", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect host_id\nfrom AIRBNB.DEV.dim_listings_cleansed\nwhere host_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-13T11:57:58.058015Z", "completed_at": "2024-05-13T11:57:58.074703Z"}, {"name": "execute", "started_at": "2024-05-13T11:57:58.081685Z", "completed_at": "2024-05-13T11:57:58.081685Z"}], "thread_id": "Thread-2", "execution_time": 0.05177474021911621, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbtearn.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313", "compiled": true, "compiled_code": "\nSELECT\n *\nFROM\n AIRBNB.DEV.dim_listings_cleansed\nWHERE\n minimum_nights < 1\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-13T11:57:58.091487Z", "completed_at": "2024-05-13T11:57:58.103500Z"}, {"name": "execute", "started_at": "2024-05-13T11:57:58.103500Z", "completed_at": "2024-05-13T11:57:58.103500Z"}], "thread_id": "Thread-1", "execution_time": 0.015004634857177734, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbtearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select host_id as from_field\n    from AIRBNB.DEV.dim_listings_cleansed\n    where host_id is not null\n),\n\nparent as (\n    select host_id as to_field\n    from AIRBNB.DEV.dim_hosts_cleansed\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-13T11:57:58.100464Z", "completed_at": "2024-05-13T11:57:58.103500Z"}, {"name": "execute", "started_at": "2024-05-13T11:57:58.119120Z", "completed_at": "2024-05-13T11:57:58.119120Z"}], "thread_id": "Thread-3", "execution_time": 0.029625892639160156, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbtearn.unique_dim_listings_cleansed_listing_id.930e4e859e", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    listing_id as unique_field,\n    count(*) as n_records\n\nfrom AIRBNB.DEV.dim_listings_cleansed\nwhere listing_id is not null\ngroup by listing_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-13T11:57:57.999472Z", "completed_at": "2024-05-13T11:57:59.233181Z"}, {"name": "execute", "started_at": "2024-05-13T11:57:59.248479Z", "completed_at": "2024-05-13T11:57:59.248479Z"}], "thread_id": "Thread-4", "execution_time": 1.368333339691162, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbtearn.no_nulls_in_dim_listings", "compiled": true, "compiled_code": "\n SELECT * FROM AIRBNB.DEV.dim_listings_cleansed WHERE\n LISTING_ID IS NULL OR\n LISTING_NAME IS NULL OR\n ROOM_TYPE IS NULL OR\n MINIMUM_NIGHTS IS NULL OR\n HOST_ID IS NULL OR\n PRICE IS NULL OR\n CREATED_AT IS NULL OR\n UPDATED_AT IS NULL OR\n \n FALSE\n", "relation_name": null}], "elapsed_time": 5.477280139923096, "args": {"log_format": "default", "static_parser": true, "version_check": true, "which": "compile", "profiles_dir": "C:\\Users\\Sunita D Agadi\\.dbt", "favor_state": false, "select": [], "log_path": "D:\\DBT_first\\dbtearn\\logs", "warn_error_options": {"include": [], "exclude": []}, "partial_parse": true, "cache_selected_only": false, "show_resource_report": false, "invocation_command": "dbt compile --target-path=prod-run-artifacts", "partial_parse_file_diff": true, "write_json": true, "strict_mode": false, "log_level": "info", "quiet": false, "log_format_file": "debug", "indirect_selection": "eager", "log_level_file": "debug", "populate_cache": true, "macro_debugging": false, "log_file_max_bytes": 10485760, "target_path": "prod-run-artifacts", "exclude": [], "output": "text", "use_colors": true, "introspect": true, "printer_width": 80, "send_anonymous_usage_stats": true, "inject_ephemeral_ctes": true, "vars": {}, "project_dir": "D:\\DBT_first\\dbtearn", "enable_legacy_logger": false, "print": true, "defer": false, "use_colors_file": true}}